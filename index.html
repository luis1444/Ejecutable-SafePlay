<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Monitor de Juegos</title>

  <style>
    /* =========================
       Tema base y resets
    ==========================*/
    :root{
      --sky-50:#f0f9ff;
      --sky-100:#e0f2fe;
      --sky-200:#bae6fd;
      --sky-300:#7dd3fc;
      --sky-400:#38bdf8;
      --sky-500:#0ea5e9;
      --sky-600:#0284c7;
      --sky-700:#0369a1;
      --ink:#2c3e50;
      --muted:#5a6c7d;
      --success:#22c55e;
      --danger:#ef4444;
      --warning:#f59e0b;
      --glass: rgba(255,255,255,.85);
      --radius:16px;
      --shadow:0 10px 30px rgba(2,132,199,.18);
      --shadow-lg:0 20px 50px rgba(2,132,199,.28);
    }

    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height:1.6; color:var(--ink);
      background: linear-gradient(135deg, #87CEEB 0%, #ffffff 100%);
      overflow-x:hidden;
      padding: 96px 0 48px; /* espacio para header fijo */
    }

    .container{max-width:1200px;margin:0 auto;padding:0 20px}

    /* =========================
       Header fijo
    ==========================*/
    header{
      position:fixed; inset:0 0 auto 0; z-index:1000;
      background: rgba(255,255,255,.9);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 20px rgba(135,206,235,.3);
    }
    nav{display:flex;align-items:center;justify-content:space-between;padding:16px 20px}
    .logo{
      font-size:1.4rem; font-weight:800; color:#0872b9; text-decoration:none; display:flex; gap:10px; align-items:center
    }
    .nav-actions{display:flex;gap:.5rem;align-items:center}
    .chip{
      font-size:.9rem; padding:6px 12px; border-radius:999px;
      background:linear-gradient(45deg, var(--sky-200), var(--sky-100));
      border:1px solid var(--sky-300); color:var(--sky-700)
    }

    /* =========================
       Modal (timer) con glassmorphism
    ==========================*/
    .modal{
      display:none; position:fixed; inset:0; z-index:1100; background:rgba(2,23,43,.45);
      backdrop-filter: blur(2px);
    }
    .modal.is-open{display:grid; place-items:center; animation: fadeIn .25s ease}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}

    .modal-content{
      width:min(640px, 95vw);
      background: rgba(255,255,255,.9);
      border:1px solid var(--sky-200);
      border-radius:20px; padding:28px;
      box-shadow: 0 30px 80px rgba(3,105,161,.25);
      transform: scale(.98);
      animation: pop .2s ease forwards;
      text-align:left;
    }
    @keyframes pop{to{transform:scale(1)}}

    .modal-header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:16px}
    .modal-title{font-size:1.5rem; font-weight:900; color:#204158}
    .modal-sub{color:var(--muted); margin-bottom:16px; font-size:1.1rem}

    .modal-grid{
      display:grid; grid-template-columns:1fr 1fr; gap:16px; margin:16px 0 12px
    }
    .field{
      background:#fff; border:2px solid var(--sky-200); border-radius:12px; padding:12px 14px;
      display:flex; align-items:center; gap:12px;
      transition: .25s ease;
    }
    .field:focus-within{border-color: var(--sky-400); box-shadow: 0 0 0 6px rgba(56,189,248,.12)}
    .field input{
      width:100%; border:none; outline:none; font-size:1.2rem; font-weight:800; color:#0b4666
    }
    .modal-actions{display:flex; justify-content:flex-end; gap:12px; margin-top:12px}

    .close-btn{
      background:#fff; border:2px solid #fecaca; color:#7f1d1d; border-radius:12px; padding:12px 16px; cursor:pointer; font-weight:800;
      transition:.2s ease
    }
    .close-btn:hover{background:#ffe4e6}

    /* Reaprovechamos tus IDs de botones para no romper JS */
    #confirmTimerBtn.timer-button{min-width:160px; padding:12px 16px}
    #cancelTimerBtn.close-btn{min-width:140px}

    /* =========================
       Bot√≥n deshabilitado
    ==========================*/
    .disabled-button {
      background: #d1d1d1; /* Color gris */
      cursor: not-allowed;
      box-shadow: none;
    }
  </style>
</head>
<body>

<!-- Header -->
<header>
  <nav class="container">
    <a class="logo" href="#">
      <img src="assets/safeplaylogo.png" alt="SafePlay Logo" style="width: 150px; height: auto;"/>
    </a>
    <div class="nav-actions">
      <span class="chip">Estado: Online</span>
    </div>
  </nav>
</header>

<main class="container">
  <div class="page-head">
    <h1>Monitor de Juegos</h1>
    <span class="sub">Controla actividad, l√≠mites de tiempo y bloqueos en un vistazo</span>
  </div>

  <!-- Contenido -->
  <div id="gameListContainer">
    <!-- El contenido se actualizar√° aqu√≠ desde renderer.js -->
    <div class="empty">
      <span class="spinner"></span> Cargando juegos‚Ä¶
    </div>
  </div>
</main>

<!-- Modal Timer -->
<div id="timerModal" class="modal" aria-hidden="true" role="dialog" aria-labelledby="timerTitle">
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="timerTitle" class="modal-title">‚è±Ô∏è Establecer tiempo de juego</h2>
      <button id="cancelTimerBtn" class="close-btn" aria-label="Cerrar">Cerrar</button>
    </div>
    <p id="modalGameName" class="modal-sub">Selecciona horas y minutos de sesi√≥n.</p>

    <div class="modal-grid">
      <label class="field" for="hoursInput">
        <span>üïí</span>
        <input type="text" id="hoursInput" placeholder="Horas" maxlength="2" inputmode="numeric"/>
      </label>
      <label class="field" for="minutesInput">
        <span>‚åõ</span>
        <input type="text" id="minutesInput" placeholder="Minutos" maxlength="2" inputmode="numeric"/>
      </label>
    </div>

    <div class="modal-actions">
      <button id="confirmTimerBtn" class="timer-button">Aceptar</button>
    </div>
  </div>
</div>

<script src="renderer.js"></script>

<script>
  const { ipcRenderer } = require('electron');

  // Bot√≥n de "Establecer tiempo"
  const confirmTimerBtn = document.getElementById("confirmTimerBtn");

  confirmTimerBtn.addEventListener("click", () => {
    const hours = parseInt(document.getElementById('hoursInput').value) || 0;
    const minutes = parseInt(document.getElementById('minutesInput').value) || 0;
    const totalMinutes = (hours * 60) + minutes;

    if (totalMinutes <= 0) {
        alert("‚ö†Ô∏è Ingresa un tiempo v√°lido.");
        return;
    }

    // Enviar el tiempo configurado al main process
    ipcRenderer.send("set-playtime", { gameName: currentGameForTimer, minutes: totalMinutes });

    // Deshabilitar el bot√≥n y ponerlo borroso despu√©s de hacer clic
    confirmTimerBtn.disabled = true;
    confirmTimerBtn.classList.add("disabled-button");
    confirmTimerBtn.textContent = "Tiempo Establecido";  // Cambiar el texto

    // Cerrar el modal
    document.getElementById("timerModal").style.display = "none";

    alert(`‚è±Ô∏è Tiempo establecido para ${currentGameForTimer}: ${totalMinutes} minutos`);
  });

  // Cerrar el modal cuando se presione el bot√≥n de cancelar
  const cancelTimerBtn = document.getElementById("cancelTimerBtn");
  cancelTimerBtn.addEventListener("click", () => {
    document.getElementById("timerModal").style.display = "none";
  });
</script>

</body>
</html>
